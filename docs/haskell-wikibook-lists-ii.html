<!DOCTYPE html>
<html lang="en">
<head>
      <title>Inconsistent Dedent - Haskell Wikibook: Lists II</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/theme/css/main.css" />
    <link rel=icon href=/theme/images/icons/favicon.png sizes="16x16" type="image/png">





</head>

<body id="index" class="home">
    <header id="banner" class="body">
    </header><!-- /#banner -->
    <nav id="menu"><ul>
        <li><a href="/">Tony Locke</a></li>
          
        <li><a href="/archives.html">Archive</a></li>
        <li><a href="https://github.com/tlocke">GitHub</a></li>
    </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">Haskell Wikibook: Lists II</h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2016-04-16T06:25:00+01:00">
      Sat 16 April 2016
    </time>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Here are my answers to the Haskell Wikibook: Lists II questions:  </p>
<blockquote>
<p>Write the following functions and test them out. Don't forget the type signatures.  </p>
<ol>
<li>
<p>takeInt returns the first <em>n</em> items in a list. So, <code>takeInt 4 [11,21,31,41,51,61]</code> returns <code>[11,21,31,41]</code>.  </p>
<div class="highlight"><pre><span></span><span class="n">takeInt</span> <span class="o">::</span> <span class="n">Integer</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">Integer</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">Integer</span><span class="p">]</span>
<span class="n">takeInt</span> <span class="mi">1</span> <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">head</span> <span class="n">l</span><span class="p">]</span>
<span class="n">takeInt</span> <span class="n">n</span> <span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span> <span class="nl">x</span> <span class="p">:</span> <span class="p">(</span><span class="n">takeInt</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">xs</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p>dropInt drops the first <em>n</em> items in a list and returns the rest. So, <code>dropInt 3 [11,21,31,41,51]</code> returns <code>[41,51]</code>.  </p>
<div class="highlight"><pre><span></span><span class="n">dropInt</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="k">Integer</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"></span>
<span class="n">dropInt</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="w"></span>
<span class="n">dropInt</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">(</span><span class="nl">_</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dropInt</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">xs</span><span class="w"></span>
</pre></div>


</li>
<li>
<p>sumInt returns the sum of the items in a list.  </p>
<div class="highlight"><pre><span></span><span class="n">sumInt</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">Integer</span><span class="w"></span>
<span class="n">sumInt</span><span class="w"> </span><span class="err">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="n">sumInt</span><span class="w"> </span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sumInt</span><span class="w"> </span><span class="n">xs</span><span class="w"></span>
</pre></div>


</li>
<li>
<p>scanSum adds the items in a list and returns a list of the running totals. So, <code>scanSum [2,3,4,5]</code> returns <code>[2,5,9,14]</code>.  </p>
<div class="highlight"><pre><span></span><span class="n">scanSum</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"></span>
<span class="n">scanSum</span><span class="w"> </span><span class="p">(</span><span class="nl">n</span><span class="p">:</span><span class="n">ns</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sSum</span><span class="w"> </span><span class="o">[</span><span class="n">n</span><span class="o">]</span><span class="w"> </span><span class="n">ns</span><span class="w"></span>
<span class="w">        </span><span class="k">where</span><span class="w"></span>
<span class="w">        </span><span class="n">sSum</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="err">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">reverse</span><span class="w"> </span><span class="n">r</span><span class="w"> </span>
<span class="w">        </span><span class="n">sSum</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sSum</span><span class="w"> </span><span class="p">((</span><span class="n">head</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="err">:</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="n">xs</span><span class="w"></span>
</pre></div>


</li>
<li>
<p>diffs returns a list of the differences between adjacent items. So, <code>diffs [3,5,6,8]</code> returns <code>[2,1,2]</code>. (Hints: one solution involves writing an auxiliary function which takes two lists and calculates the difference between corresponding elements. Alternatively, you might explore the fact that lists with at least two elements can be matched to a <code>(x:y:ys)</code> pattern.)  </p>
<div class="highlight"><pre><span></span><span class="n">diffs</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"></span>
<span class="n">diffs</span><span class="w"> </span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="nl">y</span><span class="p">:</span><span class="err">[]</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">y - x</span><span class="o">]</span><span class="w"> </span>
<span class="n">diffs</span><span class="w"> </span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="nl">y</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">diffs</span><span class="w"> </span><span class="p">(</span><span class="nl">y</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"></span>
</pre></div>


</li>
</ol>
<p>The first three functions are in Prelude under the names <code>take</code>, <code>drop</code>, and <code>sum</code>.</p>
</blockquote>
<ol>
<li>
<p>Use <code>map</code> to build functions that, given a list xs of Ints, return:</p>
<ul>
<li>
<p>A list that is the element-wise negation of xs.  </p>
<div class="highlight"><pre><span></span><span class="n">neg</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"></span>
<span class="n">neg</span><span class="w"> </span><span class="err">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"> </span>
<span class="n">neg</span><span class="w"> </span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="p">(</span><span class="n">neg</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"></span>
</pre></div>


</li>
<li>
<p>A list of lists of Ints xss that, for each element of xs, contains the divisors of xs. You can use the following function to get the divisors:</p>
<div class="highlight"><pre><span></span><span class="n">divisors</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n"> f | f &lt;- [1..p</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="err">`</span><span class="k">mod</span><span class="err">`</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">]</span><span class="w"></span>

<span class="n">divisors</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="k">Integer</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"></span>
<span class="n">divisors</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n"> f | f &lt;- -=&quot;&quot; 0=&quot;&quot; ::=&quot;&quot; divs=&quot;&quot; f=&quot;=&quot; mod=&quot;&quot; nteger=&quot;&quot; p=&quot;&quot;&gt; [[Integer</span><span class="o">]</span><span class="err">]</span><span class="w"></span>
<span class="n">divs</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="n">divisors</span><span class="w"> </span><span class="n">xs</span><span class="w"></span>
</pre></div>


</li>
<li>
<p>The element-wise negation of xss.  </p>
<div class="highlight"><pre><span></span><span class="n">neg</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Integer</span><span class="o">]</span><span class="w"></span>
<span class="n">neg</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="p">((</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="n">xs</span><span class="w"></span>
</pre></div>


</li>
</ul>
</li>
<li>
<p>Implement a Run Length Encoding (RLE) encoder and decoder.</p>
<ul>
<li>
<p>The idea of RLE is simple; given some input:</p>
<div class="highlight"><pre><span></span><span class="ss">&quot;aaaabbaaa&quot;</span>
</pre></div>


<p>compress it by taking the length of each run of characters:<code>(4,'a'), (2, 'b'), (3, 'a')</code></p>
</li>
<li>
<p>The <code>concat</code> and <code>group</code> functions might be helpful. In order to use <code>group</code>, import the Data.List module by typing <code>:m Data.List</code> at the ghci prompt or by adding <code>import Data.List</code> to your Haskell source code file.  </p>
<div class="highlight"><pre><span></span><span class="n">rleEnc</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">(Int, Char)</span><span class="o">]</span><span class="w"></span>
<span class="n">rleEnc</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="n">mt</span><span class="w"> </span><span class="p">(</span><span class="k">group</span><span class="w"> </span><span class="n">s</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">where</span><span class="w"></span>
<span class="w">        </span><span class="n">mt</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">Char</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="nc">Int</span><span class="p">,</span><span class="w"> </span><span class="nc">Char</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">mt</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="n">head</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"></span>

<span class="n">rleDec</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">(Int, Char)</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">String</span><span class="w"></span>
<span class="n">rleDec</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">concat</span><span class="w"> </span><span class="p">(</span><span class="k">map</span><span class="w"> </span><span class="n">expand</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">where</span><span class="w"> </span>
<span class="w">        </span><span class="n">expand</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">c</span><span class="o">]</span><span class="w"></span>
<span class="w">        </span><span class="n">expand</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">expand</span><span class="w"> </span><span class="p">((</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"></span>
</pre></div>


</li>
<li>
<p>What is the type of your <code>encode</code> and <code>decode</code> functions?  </p>
</li>
</ul>
<p>See type declarations above.
-   How would you convert the list of tuples (e.g. <code>[(4,'a'), (6,'b')]</code>) into a string (e.g. "4a6b")?  </p>
<div class="highlight"><pre><span></span>    <span class="nv">rleEnc</span> :: <span class="nv">String</span> <span class="o">-&gt;</span> <span class="nv">String</span>
    <span class="nv">rleEnc</span> <span class="nv">s</span> <span class="o">=</span> <span class="nv">concat</span><span class="ss">(</span><span class="nv">map</span> <span class="nv">tc</span> <span class="ss">(</span><span class="nv">rleEncTup</span> <span class="nv">s</span><span class="ss">))</span>
            <span class="nv">where</span>
            <span class="nv">tc</span> <span class="ss">(</span><span class="nv">n</span>, <span class="nv">c</span><span class="ss">)</span> <span class="o">=</span> <span class="k">show</span> <span class="nv">n</span> <span class="o">++</span> [<span class="nv">c</span>]
</pre></div>


<ul>
<li>(bonus) Assuming numeric characters are forbidden in the original string, how would you parse that string back into a list of tuples?  <div class="highlight"><pre><span></span><span class="n">rleDec</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">Char</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">Char</span><span class="o">]</span><span class="w"></span>
<span class="n">rleDec</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rleDecTup</span><span class="w"> </span><span class="p">(</span><span class="n">tuplefy</span><span class="w"> </span><span class="p">(</span><span class="n">groupBy</span><span class="w"> </span><span class="n">gb</span><span class="w"> </span><span class="n">s</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="k">where</span><span class="w"></span>
<span class="w">        </span><span class="n">gb</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="nc">Char</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Char</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Bool</span><span class="w"></span>
<span class="w">        </span><span class="n">gb</span><span class="w"> </span><span class="n">c1</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isDigit</span><span class="w"> </span><span class="n">c1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isDigit</span><span class="w"> </span><span class="n">c2</span><span class="w"></span>
<span class="w">        </span><span class="n">tuplefy</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">[Char</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">(Int, Char)</span><span class="o">]</span><span class="w"></span>
<span class="w">        </span><span class="n">tuplefy</span><span class="w"> </span><span class="err">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>
<span class="w">        </span><span class="n">tuplefy</span><span class="w"> </span><span class="p">(</span><span class="nl">ds</span><span class="p">:</span><span class="o">[</span><span class="n">c</span><span class="o">]</span><span class="err">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">read</span><span class="w"> </span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="p">(</span><span class="n">tuplefy</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"></span>
</pre></div>


</li>
</ul>
</li>
</ol>
<!-- -->

<ol>
<li>With respect to your solutions to the first set of exercises in this chapter, is there any difference between <code>scanSum (takeInt 10 [1..])</code> and <code>takeInt 10 (scanSum [1..])</code>?  </li>
</ol>
<p>Yes, the second one will take forever because it tries to complete the whole list, the first will halt.
2.  Write functions that, when applied to lists, give the <em>last</em> element of the list and the list with the last element dropped.<br>
   This functionality is provided by Prelude through the <code>last</code> and <code>init</code> functions. Like <code>head</code> and <code>tail</code>, they blow up when given empty lists.  </p>
<div class="highlight"><pre><span></span><span class="w">    </span><span class="n">myLast</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">    </span><span class="n">myLast</span><span class="w"> </span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"></span>
<span class="w">    </span><span class="n">myLast</span><span class="w"> </span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myLast</span><span class="w"> </span><span class="n">xs</span><span class="w"></span>

<span class="w">    </span><span class="n">myInit</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">[</span><span class="n">a</span><span class="o">]</span><span class="w"></span>
<span class="w">    </span><span class="n">myInit</span><span class="w"> </span><span class="o">[</span><span class="n">_</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span><span class="w"></span>
<span class="w">    </span><span class="n">myInit</span><span class="w"> </span><span class="p">(</span><span class="nl">x</span><span class="p">:</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">myInit</span><span class="w"> </span><span class="n">xs</span><span class="w"></span>
</pre></div>


</p>
  </div><!-- /.entry-content -->
</section>
    <br>
    <footer id="contentinfo" class="body">
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="/theme/images/icons/cc.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
    </footer><!-- /#contentinfo -->
</body>
</html>